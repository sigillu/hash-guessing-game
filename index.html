<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hash Guessing Game</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 2rem;
      background-color: #ffffff;
      color: #333;
    }
    .section {
      margin-bottom: 2rem;
      padding: 1rem;
      background: #f9f9f9;
      border-radius: 8px;
      border: 1px solid #ddd;
    }
    code {
      background: #f0f0f0;
      padding: 4px 6px;
      border-radius: 4px;
      display: block;
      margin: 0.5rem 0;
      font-family: monospace;
      color: #333;
    }
    .hidden { display: none; }
    button {
      background-color: #007bff;
      border: none;
      color: #fff;
      padding: 0.5rem 1rem;
      font-weight: bold;
      border-radius: 4px;
      cursor: pointer;
      margin-top: 1rem;
      margin-right: 0.5rem;
    }
    input[type="text"], select {
      padding: 0.5rem;
      border-radius: 4px;
      border: 1px solid #ccc;
      margin-right: 0.5rem;
    }
    .quiz-option {
      background-color: #f0f0f0;
      padding: 0.5rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      margin: 0.25rem 0;
      cursor: pointer;
    }
    .quiz-option:hover {
      background-color: #007bff;
      color: #fff;
    }
    ol li {
      margin-bottom: 1rem;
    }
    .fade-in {
      animation: fadeIn 1s ease-in;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .clue-hints {
      margin-top: 1rem;
      line-height: 1.6;
    }
    .hint-highlight {
      background-color: #ffffcc;
      padding: 0.25rem 0.5rem;
      border-left: 4px solid #ffcc00;
      margin-top: 0.5rem;
      display: block;
      animation: fadeInHint 0.6s ease-in-out;
    }
    @keyframes fadeInHint {
      from { opacity: 0; transform: translateY(-5px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .quiz-feedback {
      padding: 0.75rem;
      margin-top: 1rem;
      border-radius: 6px;
      font-weight: bold;
      animation: fadeInFeedback 0.6s ease-in-out;
    }
    .quiz-feedback.correct {
      background-color: #e6ffed;
      color: #207544;
      border: 1px solid #b5e2c5;
    }
    .quiz-feedback.incorrect {
      background-color: #ffeaea;
      color: #b22222;
      border: 1px solid #e2b5b5;
    }
    @keyframes fadeInFeedback {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }
  </style>
</head>
<body>
  <h1>üîê Hash Guessing Game</h1>

  <div class="section" id="categorySelect">
    <label for="category">Choose a category:</label>
    <select id="category">
      <option value="drinks">Drinks (Easy)</option>
      <option value="animals">Animals (Medium)</option>
      <option value="tech">Tech Terms (Hard)</option>
    </select>
    <button id="startGameBtn">Start Game</button>
  </div>

  <div class="section hidden" id="lesson">
    <h2>üéì What Is Hashing? (Quick Crash Course)</h2>
    <ol>
      <li>A hash is like a fingerprint for data. It turns any input into a unique string.</li>
      <li>The same input always gives the same hash. For example:
        <code>"banana" ‚Üí b9bc5a11f18c0d63f6d9d30d5e00fcb58a91a0b1fbd2f3441dc8e4edcd7a1637</code>
      </li>
      <li>Even a small change = completely different hash:
        <code>"Banana" ‚Üí 7c5507a22e37c423f5b2d4d69ae857aad8fa1e75be3e2dc7b54f77f0252fefb0</code>
      </li>
      <li>Hashes are one-way. You can go from a word to a hash, but not backward.</li>
      <li>Blockchains use hashing to protect data ‚Äî changing data changes the hash!</li>
    </ol>
    <button id="showGameBtn">Continue</button>
  </div>

  <div class="section hidden" id="game">
    <h2>üß© Guess the Word</h2>
    <p>The SHA-256 hash of the secret word is:</p>
    <code id="hashDisplay"></code>
    <p><strong>Clue:</strong> <span id="clue" class="clue-hints"></span></p>
    <input type="text" id="guessInput" placeholder="Enter your guess" style="text-transform: lowercase;" />
    <button id="submitGuessBtn">Submit Guess</button>
    <div id="result"></div>
    <div id="nextStep" class="hidden">
      <button id="goToQuizBtn">Go to Quiz</button>
    </div>
    <p id="score">Score: 0 | Streak: 0</p>
  </div>

  <div class="section hidden" id="quiz">
    <h2>üéì Quick Quiz!</h2>
    <p style="font-style: italic; color: #555;">You need at least 66% to pass the quiz.</p>
    <p id="quizQuestion">Why are hashes useful in blockchain?</p>
    <div id="quizOptions"></div>
    <div id="quizProgressBar" style="margin-top: 1rem; height: 20px; background-color: #e0e0e0; border-radius: 10px; overflow: hidden;">
      <div id="quizProgress" style="height: 100%; width: 0%; background-color: #4caf50; text-align: center; color: white; line-height: 20px; font-size: 0.8rem;"></div>
    </div>
    <div id="quizResult"></div>
  </div>

  

  <script>
    const wordCategories = {
      drinks: ["water", "juice", "latte", "cider", "mocha", "tonic", "shake", "pepsi", "lager"],
      animals: ["tiger", "zebra", "koala", "lemur", "panda", "eagle", "horse", "rhino", "llama"],
      tech: ["block", "token", "bytes", "cache", "modem", "mouse", "chips", "proxy", "cloud"]
    };

    let wordList = [];
    let categoryLabel = '';
    let secretWord = "";
    let targetHash = "";
    let attempts = 0;
    let score = 0;
    let streak = 0;

    async function hashString(str) {
      const encoder = new TextEncoder();
      const data = encoder.encode(str);
      const hashBuffer = await crypto.subtle.digest("SHA-256", data);
      const hashArray = Array.from(new Uint8Array(hashBuffer));
      return hashArray.map(b => b.toString(16).padStart(2, "0")).join("");
    }

    function startGame() {
      const category = document.getElementById("category").value;
      categoryLabel = category.charAt(0).toUpperCase() + category.slice(1);
      wordList = wordCategories[category];
      secretWord = wordList[Math.floor(Math.random() * wordList.length)];
      document.getElementById("categorySelect").classList.add("hidden");
      document.getElementById("lesson").classList.remove("hidden");
    }

    async function showGame() {
      document.getElementById("lesson").classList.add("hidden");
      document.getElementById("game").classList.remove("hidden");
      targetHash = await hashString(secretWord);
      document.getElementById("hashDisplay").textContent = targetHash;
      document.getElementById("clue").innerHTML = `It's a ${categoryLabel.toLowerCase().slice(0, -1)}, a ${secretWord.length}-letter word, lowercase only.`;
    }

    async function checkGuess() {
      const input = document.getElementById("guessInput");
      input.value = input.value.toLowerCase();
      const guess = input.value;
      input.value = "";
      const guessedHash = await hashString(guess);
      const resultDiv = document.getElementById("result");
      const clue = document.getElementById("clue");

      if (guess === secretWord) {
        // document.getElementById("correctSound").play();
        score++;
        streak++;
        resultDiv.innerHTML = `<div class='quiz-feedback correct fade-in'>‚úÖ Correct! "${guess}" matches the secret word!<br/><span style='display: block; margin-top: 0.5rem; font-family: monospace;'>Hash: <mark style='background-color: #d6f5e6; color: #207544;'>${guessedHash}</mark></span><br/>It matches the original hash.</div>`;
        document.getElementById("nextStep").classList.remove("hidden");
      } else {
        // document.getElementById("wrongSound").play();
        streak = 0;
        attempts++;
        let hints = [
          `The word starts with '${secretWord.charAt(0)}'.`,
          `The second letter is '${secretWord.charAt(1)}'.`,
          `The word ends with '${secretWord.charAt(secretWord.length - 1)}'.`,
          secretWord.length > 3 ? `The third letter is '${secretWord.charAt(2)}'.` : '',
          secretWord.length > 4 ? `The fourth letter is '${secretWord.charAt(3)}'.` : '',
          secretWord.length > 5 ? `The fifth letter is '${secretWord.charAt(4)}'.` : ''
        ].filter(Boolean);

        let newHint = attempts - 1 < hints.length ? hints[attempts - 1] : `Try rearranging your thoughts! üòâ`;
        clue.innerHTML += `<div class='hint-highlight'>Hint ${attempts}: ${newHint}</div>`;
        resultDiv.innerHTML = `<div class='quiz-feedback incorrect fade-in'>‚ùå Nope. You entered: "${guess}"<br/>
<pre style='margin-top: 0.5rem; font-family: monospace;'>Your Hash:     <mark style='background-color: #ffd6d6; color: #b22222;'>${guessedHash}</mark>
Expected Hash: <mark style='background-color: #eee0e0; color: #333;'>${targetHash}</mark></pre>
</div>`;
      }
      document.getElementById("score").textContent = `Score: ${score} | Streak: ${streak}`;
    }

    let quizIndex = 0;
    let correctAnswers = 0;
    const totalQuestions = 4;

    function goToQuiz() {
      const quizElement = document.getElementById("quiz");
      const questionElement = document.getElementById("quizQuestion");
      const optionsContainer = document.getElementById("quizOptions");
      const result = document.getElementById("quizResult");
      const progress = document.getElementById("quizProgress");

      const quizData = [
        {
          question: "Why are hashes useful in blockchain?",
          options: [
            { text: "To make data easier to read", value: "A" },
            { text: "To reverse-engineer original data", value: "B" },
            { text: "To verify that no one has changed the data", value: "C" },
            { text: "To compress large files", value: "D" }
          ],
          correct: "C"
        },
        {
          question: "What happens to the hash if the input changes slightly?",
          options: [
            { text: "It changes slightly", value: "A" },
            { text: "It stays the same", value: "B" },
            { text: "It changes completely", value: "C" },
            { text: "It becomes unreadable", value: "D" }
          ],
          correct: "C"
        },
        {
          question: "Which of the following best describes a cryptographic hash?",
          options: [
            { text: "It compresses a file to save space", value: "A" },
            { text: "It encrypts data with a secret key", value: "B" },
            { text: "It transforms input into a fixed-length, irreversible string", value: "C" },
            { text: "It sorts data alphabetically", value: "D" }
          ],
          correct: "C"
        },
        {
          question: "What is one-way functionality in hashing?",
          options: [
            { text: "You can recover the original input from the hash", value: "A" },
            { text: "Once hashed, the input cannot be reversed", value: "B" },
            { text: "Hashing is always random", value: "C" },
            { text: "Hashing uses two inputs", value: "D" }
          ],
          correct: "B"
        }
      ];

      function showNextQuestion() {
        if (quizIndex >= totalQuestions) {
          const scorePercent = Math.round((correctAnswers / totalQuestions) * 100);
          result.innerHTML = `<div class='quiz-feedback ${scorePercent >= 66 ? "correct" : "incorrect"}'>You scored ${scorePercent}%.</div>`;
          if (scorePercent < 66) {
            result.innerHTML += `<p>‚ùå You need at least 66% to pass.</p><button onclick='goToQuiz()'>Try Quiz Again</button>`;
          }
          result.innerHTML += `<button onclick='restartGame()'>Play Again</button><button onclick='exitGame()'>Exit</button>`;
          return;
        }

        const current = quizData[quizIndex];
        const sorted = current.options.sort((a, b) => a.value.localeCompare(b.value));
        questionElement.textContent = current.question;
        optionsContainer.innerHTML = "";
        result.innerHTML = "";

        sorted.forEach(option => {
          const div = document.createElement("div");
          div.className = "quiz-option";
          div.textContent = `${option.value}. ${option.text}`;
          div.onclick = () => {
            const allOptions = optionsContainer.querySelectorAll('.quiz-option');
            allOptions.forEach(opt => opt.style.pointerEvents = 'none');

            const isCorrect = option.value === current.correct;
            if (isCorrect) {
              div.style.backgroundColor = '#d1e7dd';
              div.style.borderColor = '#badbcc';
              div.style.color = '#0f5132';
            } else {
              div.style.backgroundColor = '#f8d7da';
              div.style.borderColor = '#f5c2c7';
              div.style.color = '#842029';
            }

            checkQuiz(option.value, current.correct);

            const nextBtn = document.createElement("button");
            nextBtn.textContent = "Next";
            nextBtn.onclick = showNextQuestion;
            result.appendChild(nextBtn);

            const prompt = document.createElement("p");
            prompt.textContent = 'Click Next to continue.';
            prompt.style.fontStyle = 'italic';
            prompt.style.marginTop = '0.5rem';
            result.appendChild(prompt);
          };
          optionsContainer.appendChild(div);
        });
      }

      function checkQuiz(answer, correctAnswer) {
        const result = document.getElementById("quizResult");
        const progress = document.getElementById("quizProgress");
        const correct = answer === correctAnswer;
        // Sound removed by user request

        if (correct) correctAnswers++;
        quizIndex++;

        const scorePercent = Math.round((correctAnswers / totalQuestions) * 100);
        progress.style.width = `${(correctAnswers / totalQuestions) * 100}%`;
        progress.textContent = `${scorePercent}%`;
      }

      window.checkQuiz = checkQuiz;
      window.restartGame = restartGame;
      window.exitGame = exitGame;

      document.getElementById("game").classList.add("hidden");
      quizElement.classList.remove("hidden");
      quizIndex = 0;
      correctAnswers = 0;
      progress.style.width = "0%";
      progress.textContent = "0%";
      showNextQuestion();
    }

    function restartGame() {
      window.location.reload();
    }

    function exitGame() {
      document.body.innerHTML = '<div class="section"><h2>üëã Thanks for playing!</h2><p>See you next time!</p></div>';
    }

    document.getElementById("startGameBtn").onclick = startGame;
    document.getElementById("showGameBtn").onclick = showGame;
    document.getElementById("submitGuessBtn").onclick = checkGuess;
    document.getElementById("goToQuizBtn").onclick = goToQuiz;
    document.getElementById("guessInput").addEventListener("keydown", function (event) {
      if (event.key === "Enter") {
        event.preventDefault();
        checkGuess();
      }
    });
  </script>
</body>
</html>
